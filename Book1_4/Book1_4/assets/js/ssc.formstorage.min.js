/* Licensed under the SpreadsheetConverter 2016-11-24*//*!
 * ssc.formstorage - v2.0.0
 */
"use strict";!function(){var a,b,c,d;!function(){var e={},f={};a=function(a,b,c){e[a]={deps:b,callback:c}},d=c=b=function(a){function c(b){if("."!==b.charAt(0))return b;for(var c=b.split("/"),d=a.split("/").slice(0,-1),e=0,f=c.length;f>e;e++){var g=c[e];if(".."===g)d.pop();else{if("."===g)continue;d.push(g)}}return d.join("/")}if(d._eak_seen=e,f[a])return f[a];if(f[a]={},!e[a])throw new Error("Could not find module "+a);for(var g,h=e[a],i=h.deps,j=h.callback,k=[],l=0,m=i.length;m>l;l++)k.push("exports"===i[l]?g={}:b(c(i[l])));var n=j.apply(this,k);return f[a]=g||n}}(),a("promise/all",["./utils","exports"],function(a,b){function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to all.");return new b(function(b,c){function d(a){return function(b){f(a,b)}}function f(a,c){h[a]=c,0===--i&&b(h)}var g,h=[],i=a.length;0===i&&b([]);for(var j=0;j<a.length;j++)g=a[j],g&&e(g.then)?g.then(d(j),c):f(j,g)})}var d=a.isArray,e=a.isFunction;b.all=c}),a("promise/asap",["exports"],function(a){function b(){return function(){process.nextTick(e)}}function c(){var a=0,b=new i(e),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function d(){return function(){j.setTimeout(e,1)}}function e(){for(var a=0;a<k.length;a++){var b=k[a],c=b[0],d=b[1];c(d)}k=[]}function f(a,b){var c=k.push([a,b]);1===c&&g()}var g,h="undefined"!=typeof window?window:{},i=h.MutationObserver||h.WebKitMutationObserver,j="undefined"!=typeof global?global:void 0===this?window:this,k=[];g="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?b():i?c():d(),a.asap=f}),a("promise/config",["exports"],function(a){function b(a,b){return 2!==arguments.length?c[a]:void(c[a]=b)}var c={instrument:!1};a.config=c,a.configure=b}),a("promise/polyfill",["./promise","./utils","exports"],function(a,b,c){function d(){var a;a="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var b="Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var b;return new a.Promise(function(a){b=a}),f(b)}();b||(a.Promise=e)}var e=a.Promise,f=b.isFunction;c.polyfill=d}),a("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(a,b,c,d,e,f,g,h){function i(a){if(!v(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof i))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],j(a,this)}function j(a,b){function c(a){o(b,a)}function d(a){q(b,a)}try{a(c,d)}catch(a){d(a)}}function k(a,b,c,d){var e,f,g,h,i=v(c);if(i)try{e=c(d),g=!0}catch(a){h=!0,f=a}else e=d,g=!0;n(b,e)||(i&&g?o(b,e):h?q(b,f):a===D?o(b,e):a===E&&q(b,e))}function l(a,b,c,d){var e=a._subscribers,f=e.length;e[f]=b,e[f+D]=c,e[f+E]=d}function m(a,b){for(var c,d,e=a._subscribers,f=a._detail,g=0;g<e.length;g+=3)c=e[g],d=e[g+b],k(b,c,d,f);a._subscribers=null}function n(a,b){var c,d=null;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(u(b)&&(d=b.then,v(d)))return d.call(b,function(d){return!!c||(c=!0,void(b!==d?o(a,d):p(a,d)))},function(b){return!!c||(c=!0,void q(a,b))}),!0}catch(b){return!!c||(q(a,b),!0)}return!1}function o(a,b){a===b?p(a,b):n(a,b)||p(a,b)}function p(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(r,a))}function q(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(s,a))}function r(a){m(a,a._state=D)}function s(a){m(a,a._state=E)}var t=a.config,u=(a.configure,b.objectOrFunction),v=b.isFunction,w=(b.now,c.all),x=d.race,y=e.resolve,z=f.reject,A=g.asap;t.async=A;var B=void 0,C=0,D=1,E=2;i.prototype={constructor:i,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(a,b){var c=this,d=new this.constructor(function(){});if(this._state){var e=arguments;t.async(function(){k(c._state,d,e[c._state-1],c._detail)})}else l(this,d,a,b);return d},catch:function(a){return this.then(null,a)}},i.all=w,i.race=x,i.resolve=y,i.reject=z,h.Promise=i}),a("promise/race",["./utils","exports"],function(a,b){function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to race.");return new b(function(b,c){for(var d,e=0;e<a.length;e++)d=a[e],d&&"function"==typeof d.then?d.then(b,c):b(d)})}var d=a.isArray;b.race=c}),a("promise/reject",["exports"],function(a){function b(a){var b=this;return new b(function(b,c){c(a)})}a.reject=b}),a("promise/resolve",["exports"],function(a){function b(a){if(a&&"object"==typeof a&&a.constructor===this)return a;var b=this;return new b(function(b){b(a)})}a.resolve=b}),a("promise/utils",["exports"],function(a){function b(a){return c(a)||"object"==typeof a&&null!==a}function c(a){return"function"==typeof a}function d(a){return"[object Array]"===Object.prototype.toString.call(a)}var e=Date.now||function(){return(new Date).getTime()};a.objectOrFunction=b,a.isFunction=c,a.isArray=d,a.now=e}),b("promise/polyfill").polyfill()}(),function(){function a(a){var b=this,c={db:null};if(a)for(var d in a)c[d]=a[d];return new m(function(a,d){var e=n.open(c.name,c.version);e.onerror=function(){d(e.error)},e.onupgradeneeded=function(){e.result.createObjectStore(c.storeName)},e.onsuccess=function(){c.db=e.result,b._dbInfo=c,a()}})}function b(a,b){var c=this;"string"!=typeof a&&(window.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new m(function(b,d){c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,"readonly").objectStore(e.storeName),g=f.get(a);g.onsuccess=function(){var a=g.result;void 0===a&&(a=null),b(a)},g.onerror=function(){d(g.error)}}).catch(d)});return k(d,b),d}function c(a,b){var c=this,d=new m(function(b,d){c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,"readonly").objectStore(e.storeName),g=f.openCursor();g.onsuccess=function(){var c=g.result;if(c){var d=a(c.value,c.key);void 0!==d?b(d):c.continue()}else b()},g.onerror=function(){d(g.error)}}).catch(d)});return k(d,b),d}function d(a,b,c){var d=this;"string"!=typeof a&&(window.console.warn(a+" used as a key, but it is not a string."),a=String(a));var e=new m(function(c,e){d.ready().then(function(){var f=d._dbInfo,g=f.db.transaction(f.storeName,"readwrite").objectStore(f.storeName);null===b&&(b=void 0);var h=g.put(b,a);h.onsuccess=function(){void 0===b&&(b=null),c(b)},h.onerror=function(){e(h.error)}}).catch(e)});return k(e,c),e}function e(a,b){var c=this;"string"!=typeof a&&(window.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new m(function(b,d){c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,"readwrite").objectStore(e.storeName),g=f.delete(a);g.onsuccess=function(){b()},g.onerror=function(){d(g.error)},g.onabort=function(a){var b=a.target.error;"QuotaExceededError"===b&&d(b)}}).catch(d)});return k(d,b),d}function f(a){var b=this,c=new m(function(a,c){b.ready().then(function(){var d=b._dbInfo,e=d.db.transaction(d.storeName,"readwrite").objectStore(d.storeName),f=e.clear();f.onsuccess=function(){a()},f.onerror=function(){c(f.error)}}).catch(c)});return k(c,a),c}function g(a){var b=this,c=new m(function(a,c){b.ready().then(function(){var d=b._dbInfo,e=d.db.transaction(d.storeName,"readonly").objectStore(d.storeName),f=e.count();f.onsuccess=function(){a(f.result)},f.onerror=function(){c(f.error)}}).catch(c)});return j(c,a),c}function h(a,b){var c=this,d=new m(function(b,d){return 0>a?void b(null):void c.ready().then(function(){var e=c._dbInfo,f=e.db.transaction(e.storeName,"readonly").objectStore(e.storeName),g=!1,h=f.openCursor();h.onsuccess=function(){var c=h.result;return c?void(0===a?b(c.key):g?b(c.key):(g=!0,c.advance(a))):void b(null)},h.onerror=function(){d(h.error)}}).catch(d)});return j(d,b),d}function i(a){var b=this,c=new m(function(a,c){b.ready().then(function(){var d=b._dbInfo,e=d.db.transaction(d.storeName,"readonly").objectStore(d.storeName),f=e.openCursor(),g=[];f.onsuccess=function(){var b=f.result;return b?(g.push(b.key),void b.continue()):void a(g)},f.onerror=function(){c(f.error)}}).catch(c)});return j(c,a),c}function j(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}function k(a,b){b&&a.then(function(a){l(b,a)},function(a){b(a)})}function l(a,b){return a?setTimeout(function(){return a(null,b)},0):void 0}var m="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,n=n||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(n){var o={_driver:"asyncStorage",_initStorage:a,iterate:c,getItem:b,setItem:d,removeItem:e,clear:f,length:g,key:h,keys:i};"function"==typeof define&&define.amd?define("asyncStorage",function(){return o}):"undefined"!=typeof module&&module.exports?module.exports=o:this.asyncStorage=o}}.call(window),function(){function a(a){var b=this,c={};if(a)for(var d in a)c[d]=a[d];return c.keyPrefix=c.name+"/",b._dbInfo=c,n.resolve()}function b(a){var b=this,c=new n(function(a,c){b.ready().then(function(){for(var c=b._dbInfo.keyPrefix,d=o.length-1;d>=0;d--){var e=o.key(d);0===e.indexOf(c)&&o.removeItem(e)}a()}).catch(c)});return m(c,a),c}function c(a,b){var c=this;"string"!=typeof a&&(window.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new n(function(b,d){c.ready().then(function(){try{var e=c._dbInfo,f=o.getItem(e.keyPrefix+a);f&&(f=i(f)),b(f)}catch(a){d(a)}}).catch(d)});return m(d,b),d}function d(a,b){var c=this,d=new n(function(b,d){c.ready().then(function(){try{for(var e=c._dbInfo.keyPrefix,f=e.length,g=o.length,h=0;g>h;h++){var j=o.key(h),k=o.getItem(j);if(k&&(k=i(k)),k=a(k,j.substring(f)),void 0!==k)return void b(k)}b()}catch(a){d(a)}}).catch(d)});return m(d,b),d}function e(a,b){var c=this,d=new n(function(b,d){c.ready().then(function(){var d,e=c._dbInfo;try{d=o.key(a)}catch(a){d=null}d&&(d=d.substring(e.keyPrefix.length)),b(d)}).catch(d)});return m(d,b),d}function f(a){var b=this,c=new n(function(a,c){b.ready().then(function(){for(var c=b._dbInfo,d=o.length,e=[],f=0;d>f;f++)0===o.key(f).indexOf(c.keyPrefix)&&e.push(o.key(f).substring(c.keyPrefix.length));a(e)}).catch(c)});return m(c,a),c}function g(a){var b=this,c=new n(function(a,c){b.keys().then(function(b){a(b.length)}).catch(c)});return m(c,a),c}function h(a,b){var c=this;"string"!=typeof a&&(window.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new n(function(b,d){c.ready().then(function(){var d=c._dbInfo;o.removeItem(d.keyPrefix+a),b()}).catch(d)});return m(d,b),d}function i(a){if(a.substring(0,q)!==p)return JSON.parse(a);for(var b=a.substring(C),c=a.substring(q,C),d=new ArrayBuffer(2*b.length),e=new Uint16Array(d),f=b.length-1;f>=0;f--)e[f]=b.charCodeAt(f);switch(c){case r:return d;case s:return new Blob([d]);case t:return new Int8Array(d);case u:return new Uint8Array(d);case v:return new Uint8ClampedArray(d);case w:return new Int16Array(d);case y:return new Uint16Array(d);case x:return new Int32Array(d);case z:return new Uint32Array(d);case A:return new Float32Array(d);case B:return new Float64Array(d);default:throw new Error("Unkown type: "+c)}}function j(a){var b="",c=new Uint16Array(a);try{b=String.fromCharCode.apply(null,c)}catch(a){for(var d=0;d<c.length;d++)b+=String.fromCharCode(c[d])}return b}function k(a,b){var c="";if(a&&(c=a.toString()),a&&("[object ArrayBuffer]"===a.toString()||a.buffer&&"[object ArrayBuffer]"===a.buffer.toString())){var d,e=p;a instanceof ArrayBuffer?(d=a,e+=r):(d=a.buffer,"[object Int8Array]"===c?e+=t:"[object Uint8Array]"===c?e+=u:"[object Uint8ClampedArray]"===c?e+=v:"[object Int16Array]"===c?e+=w:"[object Uint16Array]"===c?e+=y:"[object Int32Array]"===c?e+=x:"[object Uint32Array]"===c?e+=z:"[object Float32Array]"===c?e+=A:"[object Float64Array]"===c?e+=B:b(new Error("Failed to get type for BinaryArray"))),b(e+j(d))}else if("[object Blob]"===c){var f=new FileReader;f.onload=function(){var a=j(this.result);b(p+s+a)},f.readAsArrayBuffer(a)}else try{b(JSON.stringify(a))}catch(c){window.console.error("Couldn't convert value into a JSON string: ",a),b(c)}}function l(a,b,c){var d=this;"string"!=typeof a&&(window.console.warn(a+" used as a key, but it is not a string."),a=String(a));var e=new n(function(c,e){d.ready().then(function(){void 0===b&&(b=null);var f=b;k(b,function(b,g){if(g)e(g);else{try{var h=d._dbInfo;o.setItem(h.keyPrefix+a,b)}catch(a){("QuotaExceededError"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name)&&e(a)}c(f)}})}).catch(e)});return m(e,c),e}function m(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}var n="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,o=null;try{if(!(this.localStorage&&"setItem"in this.localStorage))return;o=this.localStorage}catch(a){return}var p="__lfsc__:",q=p.length,r="arbf",s="blob",t="si08",u="ui08",v="uic8",w="si16",x="si32",y="ur16",z="ui32",A="fl32",B="fl64",C=q+r.length,D={_driver:"localStorageWrapper",_initStorage:a,iterate:d,getItem:c,setItem:l,removeItem:h,clear:b,length:g,key:e,keys:f};"function"==typeof define&&define.amd?define("localStorageWrapper",function(){return D}):"undefined"!=typeof module&&module.exports?module.exports=D:this.localStorageWrapper=D}.call(window),function(){function a(a){var b=this,c={db:null};if(a)for(var d in a)c[d]="string"!=typeof a[d]?a[d].toString():a[d];return new o(function(d,e){try{c.db=p(c.name,String(c.version),c.description,c.size)}catch(c){return b.setDriver("localStorageWrapper").then(function(){return b._initStorage(a)}).then(d).catch(e)}c.db.transaction(function(a){a.executeSql("CREATE TABLE IF NOT EXISTS "+c.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){b._dbInfo=c,d()},function(a,b){e(b)})})})}function b(a,b){var c=this;"string"!=typeof a&&(window.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new o(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("SELECT * FROM "+e.storeName+" WHERE key = ? LIMIT 1",[a],function(a,c){var d=c.rows.length?c.rows.item(0).value:null;d&&(d=k(d)),b(d)},function(a,b){d(b)})})}).catch(d)});return m(d,b),d}function c(a,b){var c=this,d=new o(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("SELECT * FROM "+e.storeName,[],function(c,d){for(var e=d.rows,f=e.length,g=0;f>g;g++){var h=e.item(g),i=h.value;if(i&&(i=k(i)),i=a(i,h.key),void 0!==i)return void b(i)}b()},function(a,b){d(b)})})}).catch(d)});return m(d,b),d}function d(a,b,c){var d=this;"string"!=typeof a&&(window.console.warn(a+" used as a key, but it is not a string."),a=String(a));var e=new o(function(c,e){d.ready().then(function(){void 0===b&&(b=null);var f=b;l(b,function(b,g){if(g)e(g);else{var h=d._dbInfo;h.db.transaction(function(d){d.executeSql("INSERT OR REPLACE INTO "+h.storeName+" (key, value) VALUES (?, ?)",[a,b],function(){c(f)},function(a,b){e(b)})},function(a){a.code===a.QUOTA_ERR&&e(a)})}})}).catch(e)});return m(e,c),e}function e(a,b){var c=this;"string"!=typeof a&&(window.console.warn(a+" used as a key, but it is not a string."),a=String(a));var d=new o(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("DELETE FROM "+e.storeName+" WHERE key = ?",[a],function(){b()},function(a,b){d(b)})})}).catch(d)});return m(d,b),d}function f(a){var b=this,c=new o(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("DELETE FROM "+d.storeName,[],function(){a()},function(a,b){c(b)})})}).catch(c)});return m(c,a),c}function g(a){var b=this,c=new o(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("SELECT COUNT(key) as c FROM "+d.storeName,[],function(b,c){var d=c.rows.item(0).c;a(d)},function(a,b){c(b)})})}).catch(c)});return m(c,a),c}function h(a,b){var c=this,d=new o(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("SELECT key FROM "+e.storeName+" WHERE id = ? LIMIT 1",[a+1],function(a,c){var d=c.rows.length?c.rows.item(0).key:null;b(d)},function(a,b){d(b)})})}).catch(d)});return m(d,b),d}function i(a){var b=this,c=new o(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("SELECT key FROM "+d.storeName,[],function(b,c){for(var d=[],e=0;e<c.rows.length;e++)d.push(c.rows.item(e).key);a(d)},function(a,b){c(b)})})}).catch(c)});return m(c,a),c}function j(a){var b,c=new Uint8Array(a),d="";for(b=0;b<c.length;b+=3)d+=n[c[b]>>2],d+=n[(3&c[b])<<4|c[b+1]>>4],d+=n[(15&c[b+1])<<2|c[b+2]>>6],d+=n[63&c[b+2]];return c.length%3===2?d=d.substring(0,d.length-1)+"=":c.length%3===1&&(d=d.substring(0,d.length-2)+"=="),d}function k(a){if(a.substring(0,r)!==q)return JSON.parse(a);var b,c,d,e,f,g=a.substring(D),h=a.substring(r,D),i=.75*g.length,j=g.length,k=0;"="===g[g.length-1]&&(i--,"="===g[g.length-2]&&i--);var l=new ArrayBuffer(i),m=new Uint8Array(l);for(b=0;j>b;b+=4)c=n.indexOf(g[b]),d=n.indexOf(g[b+1]),e=n.indexOf(g[b+2]),f=n.indexOf(g[b+3]),m[k++]=c<<2|d>>4,m[k++]=(15&d)<<4|e>>2,m[k++]=(3&e)<<6|63&f;switch(h){case s:return l;case t:return new Blob([l]);case u:return new Int8Array(l);case v:return new Uint8Array(l);case w:return new Uint8ClampedArray(l);case x:return new Int16Array(l);case z:return new Uint16Array(l);case y:return new Int32Array(l);case A:return new Uint32Array(l);case B:return new Float32Array(l);case C:return new Float64Array(l);default:throw new Error("Unkown type: "+h)}}function l(a,b){var c="";if(a&&(c=a.toString()),a&&("[object ArrayBuffer]"===a.toString()||a.buffer&&"[object ArrayBuffer]"===a.buffer.toString())){var d,e=q;a instanceof ArrayBuffer?(d=a,e+=s):(d=a.buffer,"[object Int8Array]"===c?e+=u:"[object Uint8Array]"===c?e+=v:"[object Uint8ClampedArray]"===c?e+=w:"[object Int16Array]"===c?e+=x:"[object Uint16Array]"===c?e+=z:"[object Int32Array]"===c?e+=y:"[object Uint32Array]"===c?e+=A:"[object Float32Array]"===c?e+=B:"[object Float64Array]"===c?e+=C:b(new Error("Failed to get type for BinaryArray"))),b(e+j(d))}else if("[object Blob]"===c){var f=new FileReader;f.onload=function(){var a=j(this.result);b(q+t+a)},f.readAsArrayBuffer(a)}else try{b(JSON.stringify(a))}catch(c){window.console.error("Couldn't convert value into a JSON string: ",a),b(null,c)}}function m(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,p=this.openDatabase,q="__lfsc__:",r=q.length,s="arbf",t="blob",u="si08",v="ui08",w="uic8",x="si16",y="si32",z="ur16",A="ui32",B="fl32",C="fl64",D=r+s.length;if(p){var E={_driver:"webSQLStorage",_initStorage:a,iterate:c,getItem:b,setItem:d,removeItem:e,clear:f,length:g,key:h,keys:i};"function"==typeof define&&define.amd?define("webSQLStorage",function(){return E}):"undefined"!=typeof module&&module.exports?module.exports=E:this.webSQLStorage=E}}.call(window),function(){function a(a,b){a[b]=function(){var c=arguments;return a.ready().then(function(){return a[b].apply(a,c)})}}function b(){for(var a=1;a<arguments.length;a++){var b=arguments[a];if(b)for(var c in b)b.hasOwnProperty(c)&&(arguments[0][c]=n(b[c])?b[c].slice():b[c])}return arguments[0]}function c(a){for(var b in g)if(g.hasOwnProperty(b)&&g[b]===a)return!0;return!1}function d(c){this._config=b({},k,c),this._driverSet=null,this._ready=!1,this._dbInfo=null;for(var d=0;d<i.length;d++)a(this,i[d]);this.setDriver(this._config.driver)}var e="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,f={},g={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},h=[g.INDEXEDDB,g.WEBSQL,g.LOCALSTORAGE],i=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],j={DEFINE:1,EXPORT:2,WINDOW:3},k={description:"",driver:h.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},l=j.WINDOW;"function"==typeof define&&define.amd?l=j.DEFINE:"undefined"!=typeof module&&module.exports&&(l=j.EXPORT);var m=function(a){var b=b||a.indexedDB||a.webkitIndexedDB||a.mozIndexedDB||a.OIndexedDB||a.msIndexedDB,c={};return c[g.WEBSQL]=!!a.openDatabase,c[g.INDEXEDDB]=!!function(){if("undefined"!=typeof a.openDatabase&&a.navigator&&a.navigator.userAgent&&/Safari/.test(a.navigator.userAgent)&&!/Chrome/.test(a.navigator.userAgent))return!1;try{return b&&"function"==typeof b.open&&"undefined"!=typeof a.IDBKeyRange}catch(a){return!1}}(),c[g.LOCALSTORAGE]=!!function(){try{return a.localStorage&&"setItem"in a.localStorage&&a.localStorage.setItem}catch(a){return!1}}(),c}(this),n=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},o=this;d.prototype.INDEXEDDB=g.INDEXEDDB,d.prototype.LOCALSTORAGE=g.LOCALSTORAGE,d.prototype.WEBSQL=g.WEBSQL,d.prototype.config=function(a){if("object"==typeof a){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var b in a)"storeName"===b&&(a[b]=a[b].replace(/\W/g,"_")),this._config[b]=a[b];return"driver"in a&&a.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof a?this._config[a]:this._config},d.prototype.defineDriver=function(a,b,d){var g=new e(function(b,d){try{var g=a._driver,h=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),j=new Error("Custom driver name already in use: "+a._driver);if(!a._driver)return void d(h);if(c(a._driver))return void d(j);for(var k=i.concat("_initStorage"),l=0;l<k.length;l++){var n=k[l];if(!n||!a[n]||"function"!=typeof a[n])return void d(h)}var o=e.resolve(!0);"_support"in a&&(o=a._support&&"function"==typeof a._support?a._support():e.resolve(!!a._support)),o.then(function(c){m[g]=c,f[g]=a,b()},d)}catch(a){d(a)}});return g.then(b,d),g},d.prototype.driver=function(){return this._driver||null},d.prototype.ready=function(a){var b=this,c=new e(function(a,c){b._driverSet.then(function(){null===b._ready&&(b._ready=b._initStorage(b._config)),b._ready.then(a,c)}).catch(c)});return c.then(a,a),c},d.prototype.setDriver=function(a,b,d){function g(){h._config.driver=h.driver()}var h=this;return"string"==typeof a&&(a=[a]),this._driverSet=new e(function(b,d){var g=h._getFirstSupportedDriver(a),i=new Error("No available storage method found.");if(!g)return h._driverSet=e.reject(i),void d(i);if(h._dbInfo=null,h._ready=null,c(g)){if(l===j.DEFINE)return void require([g],function(a){h._extend(a),b()});if(l===j.EXPORT){var k;switch(g){case h.INDEXEDDB:k=require("./drivers/indexeddb");break;case h.LOCALSTORAGE:k=require("./drivers/localstorage");break;case h.WEBSQL:k=require("./drivers/websql")}h._extend(k)}else h._extend(o[g])}else{if(!f[g])return h._driverSet=e.reject(i),void d(i);h._extend(f[g])}b()}),this._driverSet.then(g,g),this._driverSet.then(b,d),this._driverSet},d.prototype.supports=function(a){return!!m[a]},d.prototype._extend=function(a){b(this,a)},d.prototype._getFirstSupportedDriver=function(a){if(a&&n(a))for(var b=0;b<a.length;b++){var c=a[b];if(this.supports(c))return c}return null},d.prototype.createInstance=function(a){return new d(a)};var p=new d;l===j.DEFINE?define("localforage",function(){return p}):l===j.EXPORT?module.exports=p:this.localforage=p}.call(window),$.fn.serializeObject=function(a){var b={},c=this.serializeArray();return $.each(c,function(){if(this.name.indexOf("xl_")==-1){var c=(a&&this.value?ssc.utils.replaceSpecialCharAndEncode(this.value):this.value)||"";b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(c)):b[this.name]=c}}),b};var ssc=ssc||{};ssc.utils=function(){return{checkIfMSIE:function(){var a=window.navigator.userAgent,b=a.indexOf("MSIE "),c=a.indexOf(".NET CLR");return!(b===-1&&c===-1)},checkIfFileURI:function(){var a=document.location,b=a.protocol.indexOf("file:");return!(b===-1)},checkIfBrowserSupportStorageSystem:function(){return!(this.checkIfMSIE()&&this.checkIfFileURI())},size:function(a){var b=0,c=JSON.stringify(a);return b=c.length},replaceSpecialCharAndEncode:function(a){return encodeURIComponent(a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\/]/g,"\\/").replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t"))},getJsonPageMeta:function(){var a={};return $("input[id^=xl_]").each(function(){a[$(this).attr("name")]=ssc.utils.replaceSpecialCharAndEncode($(this).val())}),a}}}();var ssc=ssc||{};ssc.formSubmitModule=function(){var a={url_echo_server:"https://share.spreadsheetconverter.com/echo/",url_submit_server:"https://share.spreadsheetconverter.com/submit/",url_submit_multiform_server:"",before_onlineformsubmit_callback:void 0,after_onlineformsubmit_callback:void 0,after_offlineformsubmit_callback:void 0,getJsonFormData_callback:void 0},b=function(a,b){$.ajax({cache:!1,crossDomain:!0,type:"GET",dataType:"text",timeout:8e3,url:ssc.formSubmitModule.options.url_echo_server,success:function(b){a(b)},error:function(a,c,d){b(c)}})},c=function(a,b,c){$.ajax({type:"POST",crossDomain:!0,contentType:"application/json; charset=utf-8",url:ssc.formSubmitModule.options.url_submit_server,data:JSON.stringify(a),success:function(a){b(a)},error:function(a,b,d){c()}})},d=function(a){var b=$.extend(!0,ssc.formSubmitModule.getJsonFormData(),ssc.utils.getJsonPageMeta()),d=ssc.utils.size(b);return d>1e6?a():c(b,function(a){ssc.formSubmitModule.options.after_onlineformsubmit_callback("success",a)},function(a){ssc.formSubmitModule.options.after_onlineformsubmit_callback("error","The submit has failed. Please try submitting the form after a while.")}),!1},e=function(){function a(c){if(d.length>c){var f=d[c];localforage.getItem(f,function(f,h){if(!f){var j=ssc.utils.size(h);g+=j,g<=9e5&&c<10?(i.push(d[c]),e.push(h),++c,d.length>c?a(c):b()):b()}})}}function b(){var b={};b.forms=e;var j=$.extend(!0,b,ssc.utils.getJsonPageMeta());c(j,function(b){function c(j){if(i.length>j){var k=i[j];localforage.removeItem(k,function(k){k||(d.splice(0,1),0===d.length&&ssc.formSubmitModule.options.after_offlineformsubmit_callback&&ssc.formSubmitModule.options.after_offlineformsubmit_callback("success",b),ssc.Global.formStorage.formStorageUpdateCallback(--h,"delete"),++j,i.length>j?c(j):(g=f,i=new Array,e=new Array,a(0)))})}}var j=0;c(j)},function(){ssc.formSubmitModule.options.after_offlineformsubmit_callback&&ssc.formSubmitModule.options.after_offlineformsubmit_callback("error",status)})}var d=new Array,e=new Array,f=ssc.utils.size(ssc.utils.getJsonPageMeta()),g=f,h=0,i=new Array;localforage.iterate(function(a,b,c){d.push(b)},function(){var b=d.indexOf("this_form_");b>-1&&d.splice(b,1);d.sort(function(a,b){var c=a.length,d=b.length,e=a.substring(8,c),f=b.substring(8,d);return e-f});h=d.length,ssc.Global.formStorage.formStorageUpdateCallback(h,"submit"),a(0)})};return{callIfOnlineElse:b,submitThisForm:d,submitOnceMultiForm:e,getJsonFormData:void 0,config:function(b){this.options=this.options?$.extend({},this.options,b):$.extend({},a,b),this.getJsonFormData=this.options.getJsonFormData_callback}}}();var ssc=ssc||{};ssc.FormStorageClass=function(){function a(a){var b="undefined"!=typeof a&&a.hasOwnProperty("dbName")?a.dbName:"workbook",c="undefined"!=typeof a&&a.hasOwnProperty("offlineStoreUpdate")?a.offlineStoreUpdate:void 0,d="undefined"!=typeof a&&a.hasOwnProperty("callback_AfterOfflineStore")?a.callback_AfterOfflineStore:void 0;return localforage.config({driver:[localforage.INDEXEDDB,localforage.LOCALSTORAGE],name:b,version:1,storeName:b}),{storeThisForm:function(a,b){localforage.setItem("this_form_",a,b)},formStorageUpdateCallback:c,saveFormAsOfflineSubmitInStorage:function(a){var b=ssc.utils.size(ssc.utils.getJsonPageMeta());b+=ssc.utils.size(a),b>9e5?"undefined"!==d&&d("error","The form is larger than the maximum size and cannot be saved."):this.asyncGetSavedFormsCount(function(b){var e="_submit_1";b>=0&&(e="_submit_"+ ++b),function(b){localforage.setItem(e,a,function(a,e){b>0&&("undefined"!==c&&c(b,"save"),"undefined"!==d&&d("success"))})}(b)})},restoreThisFormDataFromStorage:function(a){localforage.getItem("this_form_",function(b,c){if(null!==c&&"object"==typeof c)for(var d in c)c.hasOwnProperty(d)&&ssc.formBinder.bind(d,c[d]);a("")})},asyncReadEachSavedForm:function(a){try{localforage.keys(function(b,c){if(c.length>0)for(var d=0;d<c.length;d++)"_"===c[d].charAt(0)&&!function(b){localforage.getItem(b,function(c,d){a(b,d)})}(c[d])})}catch(a){}},asyncGetSavedFormsCount:function(a){localforage.keys(function(b,c){var d=0;if(c.length>0)for(var e=0;e<c.length;e++)"_"===c[e].charAt(0)&&d++;a(d)})},asyncGetSavedFormsKeys:function(a){localforage.keys(function(b,c){var d=new Array;if(c.length>0)for(var e=0;e<c.length;e++)"_"===c[e].charAt(0)&&d.push(c[e]);a(d)})},asyncRemoveSavedFormByKey:function(a,b){localforage.removeItem(a,function(a){"undefined"!==c&&localforage.keys(function(a,b){c(b.length-1,"delete")})})},asyncRemoveAllSavedForms:function(a){this.asyncGetSavedFormsKeys(function(b){for(var c in b)c<b.length-1?localforage.removeItem(b[c],function(a){}):(localforage.removeItem(b[c],function(a){}),a())})}}}var b;return{getInstance:function(c){return b||(b=a(c)),b}}}(),String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.indexOf(a,b)===b}),!function(a){a(["jquery"],function(a){return function(){function b(a,b,c){return o({type:v.error,iconClass:p().iconClasses.error,message:a,optionsOverride:c,title:b})}function c(b,c){return b||(b=p()),r=a("#"+b.containerId),r.length?r:(c&&(r=l(b)),r)}function d(a,b,c){return o({type:v.info,iconClass:p().iconClasses.info,message:a,optionsOverride:c,title:b})}function e(a){s=a}function f(a,b,c){return o({type:v.success,iconClass:p().iconClasses.success,message:a,optionsOverride:c,title:b})}function g(a,b,c){return o({type:v.warning,iconClass:p().iconClasses.warning,message:a,optionsOverride:c,title:b})}function h(a){var b=p();r||c(b),k(a,b)||j(b)}function i(b){var d=p();return r||c(d),b&&0===a(":focus",b).length?void q(b):void(r.children().length&&r.remove())}function j(b){for(var c=r.children(),d=c.length-1;d>=0;d--)k(a(c[d]),b)}function k(b,c){return!(!b||0!==a(":focus",b).length)&&(b[c.hideMethod]({duration:c.hideDuration,easing:c.hideEasing,complete:function(){q(b)}}),!0)}function l(b){return r=a("<div/>").attr("id",b.containerId).addClass(b.positionClass).attr("aria-live","polite").attr("role","alert"),r.appendTo(a(b.target)),r}function m(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:void 0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",target:"body",closeHtml:'<button type="button">&times;</button>',newestOnTop:!0,preventDuplicates:!1,progressBar:!1}}function n(a){s&&s(a)}function o(b){function d(b){return!a(":focus",k).length||b?(clearTimeout(v.intervalId),k[h.hideMethod]({duration:h.hideDuration,easing:h.hideEasing,complete:function(){q(k),h.onHidden&&"hidden"!==w.state&&h.onHidden(),w.state="hidden",w.endTime=new Date,n(w)}})):void 0}function e(){(h.timeOut>0||h.extendedTimeOut>0)&&(j=setTimeout(d,h.extendedTimeOut),v.maxHideTime=parseFloat(h.extendedTimeOut),v.hideEta=(new Date).getTime()+v.maxHideTime)}function f(){clearTimeout(j),v.hideEta=0,k.stop(!0,!0)[h.showMethod]({duration:h.showDuration,easing:h.showEasing})}function g(){var a=(v.hideEta-(new Date).getTime())/v.maxHideTime*100;o.width(a+"%")}var h=p(),i=b.iconClass||h.iconClass;if("undefined"!=typeof b.optionsOverride&&(h=a.extend(h,b.optionsOverride),i=b.optionsOverride.iconClass||i),h.preventDuplicates){if(b.message===t)return;t=b.message}u++,r=c(h,!0);var j=null,k=a("<div/>"),l=a("<div/>"),m=a("<div/>"),o=a("<div/>"),s=a(h.closeHtml),v={
intervalId:null,hideEta:null,maxHideTime:null},w={toastId:u,state:"visible",startTime:new Date,options:h,map:b};return b.iconClass&&k.addClass(h.toastClass).addClass(i),b.title&&(l.append(b.title).addClass(h.titleClass),k.append(l)),b.message&&(m.append(b.message).addClass(h.messageClass),k.append(m)),h.closeButton&&(s.addClass("toast-close-button").attr("role","button"),k.prepend(s)),h.progressBar&&(o.addClass("toast-progress"),k.prepend(o)),k.hide(),h.newestOnTop?r.prepend(k):r.append(k),k[h.showMethod]({duration:h.showDuration,easing:h.showEasing,complete:h.onShown}),h.timeOut>0&&(j=setTimeout(d,h.timeOut),v.maxHideTime=parseFloat(h.timeOut),v.hideEta=(new Date).getTime()+v.maxHideTime,h.progressBar&&(v.intervalId=setInterval(g,10))),k.hover(f,e),!h.onclick&&h.tapToDismiss&&k.click(d),h.closeButton&&s&&s.click(function(a){a.stopPropagation?a.stopPropagation():void 0!==a.cancelBubble&&a.cancelBubble!==!0&&(a.cancelBubble=!0),d(!0)}),h.onclick&&k.click(function(){h.onclick(),d()}),n(w),h.debug&&console&&void 0,k}function p(){return a.extend({},m(),w.options)}function q(a){r||(r=c()),a.is(":visible")||(a.remove(),a=null,0===r.children().length&&(r.remove(),t=void 0))}var r,s,t,u=0,v={error:"error",info:"info",success:"success",warning:"warning"},w={clear:h,remove:i,error:b,getContainer:c,info:d,options:{},subscribe:e,success:f,version:"2.1.0",warning:g};return w}()})}("function"==typeof define&&define.amd?define:function(a,b){"undefined"!=typeof module&&module.exports?module.exports=b(require("jquery")):window.toastr=b(window.jQuery)}),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){if(!a.support.cors&&a.ajaxTransport&&window.XDomainRequest){var b=/^https?:\/\//i,c=/^get|post$/i,d=new RegExp("^"+location.protocol,"i");a.ajaxTransport("* text html xml json",function(e,f,g){if(e.crossDomain&&e.async&&c.test(e.type)&&b.test(e.url)&&d.test(e.url)){var h=null;return{send:function(b,c){var d="",g=(f.dataType||"").toLowerCase();h=new XDomainRequest,/^\d+$/.test(f.timeout)&&(h.timeout=f.timeout),h.ontimeout=function(){c(500,"timeout")},h.onload=function(){var b="Content-Length: "+h.responseText.length+"\r\nContent-Type: "+h.contentType,d={code:200,message:"success"},e={text:h.responseText};try{if("html"===g||/text\/html/i.test(h.contentType))e.html=h.responseText;else if("json"===g||"text"!==g&&/\/json/i.test(h.contentType))try{e.json=a.parseJSON(h.responseText)}catch(a){d.code=500,d.message="parseerror"}else if("xml"===g||"text"!==g&&/\/xml/i.test(h.contentType)){var f=new ActiveXObject("Microsoft.XMLDOM");f.async=!1;try{f.loadXML(h.responseText)}catch(a){f=void 0}if(!f||!f.documentElement||f.getElementsByTagName("parsererror").length)throw d.code=500,d.message="parseerror","Invalid XML: "+h.responseText;e.xml=f}}catch(a){throw a}finally{c(d.code,d.message,e,b)}},h.onprogress=function(){},h.onerror=function(){c(500,"error",{text:h.responseText})},f.data&&(d="string"===a.type(f.data)?f.data:a.param(f.data)),h.open(e.type,e.url),h.send(d)},abort:function(){h&&h.abort()}}}})}}),!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()}(this,function(){function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return m[e]||(k.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",k.cssRules.length),m[e]=1),e}function d(a,b){var c,d,e=a.style;if(b=b.charAt(0).toUpperCase()+b.slice(1),void 0!==e[b])return b;for(d=0;d<l.length;d++)if(c=l[d]+b,void 0!==e[c])return c}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function h(a){this.opts=f(a||{},h.defaults,n)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}k.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function h(a,h,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~h}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.scale*d.width,left:d.scale*d.radius,top:-d.scale*d.width>>1,filter:i}),c("fill",{color:g(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.scale*(d.length+d.width),k=2*d.scale*j,l=-(d.width+d.length)*d.scale*2+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)h(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)h(i);return b(a,m)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k,l=["webkit","Moz","ms","O"],m={},n={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};if(h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=a(null,{className:d.className});if(e(f,{position:d.position,width:0,zIndex:d.zIndex,left:d.left,top:d.top}),b&&b.insertBefore(f,b.firstChild||null),f.setAttribute("role","progressbar"),c.lines(f,c.opts),!j){var g,h=0,i=(d.lines-1)*(1-d.direction)/2,k=d.fps,l=k/d.speed,m=(1-d.opacity)/(l*d.trail/100),n=l/d.lines;!function a(){h++;for(var b=0;b<d.lines;b++)g=Math.max(1-(h+(d.lines-b)*n)%l*m,d.opacity),c.opacity(f,b*d.direction+i,g,d);c.timeout=c.el&&setTimeout(a,~~(1e3/k))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function h(b,c){return e(a(),{position:"absolute",width:f.scale*(f.length+f.width)+"px",height:f.scale*f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*k+f.rotate)+"deg) translate("+f.scale*f.radius+"px,0)",borderRadius:(f.corners*f.scale*f.width>>1)+"px"})}for(var i,k=0,l=(f.lines-1)*(1-f.direction)/2;k<f.lines;k++)i=e(a(),{position:"absolute",top:1+~(f.scale*f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,l+k*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(h("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,h(g(f.color,k),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}}),"undefined"!=typeof document){k=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}();var o=e(a("group"),{behavior:"url(#default#VML)"});!d(o,"transform")&&o.adj?i():j=d(o,"animation")}return h});var ssc=ssc||{};ssc.Spinner=function(){function a(a){var c=b(),d=a.find(".spin"),e={start:function(){a.attr("disabled",""),a.attr("data-loading",""),c.spin(),d.append(c.el)},stop:function(){c.stop(),$("[role='progressbar']").remove(),a.removeAttr("disabled"),a.removeAttr("data-loading")}};return e}function b(){var a={lines:11,length:3,width:2,radius:5,corners:.4,rotate:19,direction:1,color:"#fff",speed:1,trail:22,shadow:!1,hwaccel:!1,className:"",zIndex:2e9,top:"50%",left:"50%"},b=new Spinner(a).spin();return b}function c(){e=b();var a='<div id="modalspinner" style="z-index: 10000;display: block;position:absolute!important;" class="modal">            <span class="spin" style="position: absolute;display: block;top:0;bottom:0;right:0;left:0;width: 40px;height: 40px; border-radius: 22px;background-color: #3F3F3F;z-index: 1;margin:auto;"></span>        </div>';$("form").append(a),e.spin(),$("#modalspinner .spin").append(e.el)}function d(){e&&(e.stop(),e=void 0),$("#modalspinner").remove()}var e=void 0;return{create:a,showModalSpinner:c,destroyModalSpinner:d}}(),$(function(){ssc.ssc_bs=!0;var a=$("body").attr("browserstorage");a&&(ssc.ssc_bs="true"==a),!ssc.utils.checkIfBrowserSupportStorageSystem();var b=function(a){var b=$("#formc input,textarea,select"),c=b.filter(":hiddenByParent"),d=c.serializeObject(a);$("#formc input:checkbox").map(function(){d[this.name]=this.checked?"on":"off"});for(var e=ssc.attachments||[],f=e.length,g=0;g<f;g++)d["xll_fileid"+g]=encodeURIComponent(e[g]);return d};ssc.formSubmitModule.config({getJsonFormData_callback:function(){return b(!0)}});var c="    <div id='offlineforms-submit' class='hideme'>        <button id='offlineforms-submit-btn' type='button' class='btn btn-offlineforms-submit btn-sm'>        <span class='offlineforms-logo'></span><span>Offline Forms</span>        <span id='x1' class='badge badge-offlineforms-submit' >0</span>        </button>    </div>",d="<div id='formsaving' style='background-color: #FFD76E;position: fixed; left: 50%; top: 10px;z-index: 1000000; padding-left: 1em;padding-right: 1ex;text-align: center; border: 1px solid #E4C471;border-radius: 2px;' class='hideme'>saving form...</div>",e='<!-- Modal -->    <div class="modal fade" id="onlinefom-submit-conformation-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">    <div class="modal-dialog modal-sm">    <div class="modal-content" >    <div class="modal-body">    <span class="glyphicon glyphicon-send form-submit"></span>    <p class="info">'+ssc.Dialog.BeforeSubmitDesc+'</p>    </div>    </div>    </div>    </div>        <!-- Modal -->    <div class="modal fade" id="onlineform-submit-status-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">    <div class="modal-dialog modal-sm">    <div class="modal-content" >    <div class="modal-header">    <h4 class="modal-title">form submit</h4>    </div>    <div class="modal-body">    <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>-->    <span class="glyphicon glyphicon-warning-sign status-icon"></span>    <p class="info">The form is being submitted.</p>    </div>    <div class="modal-footer">    <button type="button" class="btn btn-link" id="onlineform-submit-status-modal-close-btn" style="margin-left:4px">Close</button>    </div>    </div>    </div>    </div>        <!-- Modal -->    <div class="modal fade" id="offlineforms-save-conformation-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">    <div class="modal-dialog modal-sm">    <div class="modal-content">    <div class="modal-header">    <h4 class="modal-title">'+ssc.Dialog.OfflineHeading+'</h4>    </div>    <div class="modal-body">    <span class="glyphicon glyphicon-save status-icon" style="color:brown"/>    <p class="info">'+ssc.Dialog.OfflineDesc+'</p>    <p class="conform">'+ssc.Dialog.OfflineConfirm+'</p>    </div>    <div class="modal-footer">    <button type="button" id=\'offlineforms-save-conformation-yes-btn\' class="btn btn-default" onclick="offlineforms_save_conformation_yes_btn_click()" data-loading-text="Done">Yes</button>    <button type="button" class="btn btn-link" onclick=\'$("#offlineforms-save-conformation-modal").modal("hide");return false;\' style="margin-left:4px">No</button>    </div>    </div>    </div>    </div>        <!-- Modal -->    <div class="modal fade" id="offlineforms-submit-conformation-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">    <div class="modal-dialog modal-sm">    <div class="modal-content">    <div class="modal-header">    <h4 class="modal-title">'+ssc.Dialog.OfflineSubmitHeading+'</h4>    </div>    <div class="modal-body">    <span class="glyphicon glyphicon-export status-icon" style="color:brown"/>    <p class="info">'+ssc.Dialog.OfflineSubmitDesc+'</p>    <p class="conform">'+ssc.Dialog.OfflineSubmitConfirm+'</p>    </div>    <div class="modal-footer">    <button type="button" id=\'offlineforms-submit-conformation-yes-btn\' class="btn btn-default" onclick="offlineforms_submit_conformation_yes_btn_click()" data-loading-text="submitting...">Yes</button>    <button type="button" class="btn btn-link" onclick=\'$("#offlineforms-submit-conformation-modal").modal("hide");return false;\' style="margin-left:4px">No</button>    </div>    </div>    </div>    </div>        <!-- Modal -->    <div class="modal fade" id="offlineforms-submit-status-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">    <div class="modal-dialog modal-sm">    <div class="modal-content">    <div class="modal-header">    <h4 class="modal-title">'+ssc.Dialog.FailOfflineHeading+'</h4>    </div>    <div class="modal-body">    <span class="glyphicon glyphicon-warning-sign status-icon" style="color:rgb(198,0,0)"></span>    <p class="info">'+ssc.Dialog.FailOfflineDesc+'</p>    </div>    <div class="modal-footer">    <button type="button" id="offlineforms-submit-status-modal-close-btn" class="btn btn-link" style="margin-left:4px">Close</button>    </div>    </div>    </div>    </div>';ssc.formSubmitModule.showOfflineConformationDialog=function(){ssc.ssc_bs?$("#offlineforms-save-conformation-modal").modal("show"):($("#offlineforms-submit-status-modal .modal-title").html("Submit Failed"),$("#offlineforms-submit-status-modal p.info").html("Unable to connect to the Internet<br/>Please try submitting the Forms later in internet connection."),$("#offlineforms-submit-status-modal").modal("show"))},$(".toolbar-panel-right").prepend(c),$("#formc").prepend(d),$("#formc").append(e);var f="wookbook1";void 0!==ssc.APPNAME&&ssc.APPNAME.length>0&&(f=ssc.APPNAME.toLowerCase()),ssc.Global=ssc.Global||{},ssc.Global.formStorage=ssc.FormStorageClass.getInstance({dbName:f,offlineStoreUpdate:function(a,b){$("#x1").html(a),$("#offlineforms-submit-conformation-modal .conform").text(a+ssc.Dialog.OfflineSubmitWaitCounter),a>0?($("#offlineforms-submit").removeClass("hideme"),$("#offlineforms-submit").addClass("showme")):($("#offlineforms-submit").removeClass("showme"),$("#offlineforms-submit").addClass("hideme"))},callback_AfterOfflineStore:function(a,b){$("#offlineforms-save-conformation-modal").modal("hide"),"error"===a&&alert(b)}}),window.origi_recalc_onclick=void 0,window.autosaveing=!1,window.repobuff=[],ssc.ssc_bs&&ssc.utils.checkIfBrowserSupportStorageSystem()&&(window.origi_recalc_onclick=recalc_onclick,window.recalc_onclick=function(a){origi_recalc_onclick&&origi_recalc_onclick(a),a.length>0&&(window.autosaveing||(window.autosaveing=!0,setTimeout(function(){if($("#formsaving").removeClass("hideme").addClass("showme"),"undefined"!==ssc.Global.formStorage){var a=b(!1);ssc.Global.formStorage.storeThisForm(a,function(a){setTimeout(function(){$("#formsaving").removeClass("showme").addClass("hideme")},500),window.autosaveing=!1})}},1e3)))}),ssc.Global.formStorage.restoreThisFormDataFromStorage(recalc_onclick),ssc.Global.formStorage.asyncGetSavedFormsCount(function(a){a>0?($("#offlineforms-submit").removeClass("hideme"),$("#offlineforms-submit").addClass("showme"),$("#x1").html(a)):($("#offlineforms-submit").removeClass("showme"),$("#offlineforms-submit").addClass("hideme"),$("#x1").html(a))}),$("#offlineforms-submit-btn").click(function(){ssc.Spinner.showModalSpinner(),ssc.formSubmitModule.callIfOnlineElse(function(){ssc.Global.formStorage.asyncGetSavedFormsCount(function(a){ssc.Spinner.destroyModalSpinner();var b=ssc.Dialog.OfflineSubmitDesc;$("#offlineforms-submit-conformation-yes-btn").button("reset"),$("#offlineforms-submit-conformation-modal .modal-body .info").html(b),$("#offlineforms-submit-conformation-modal .conform").html(ssc.Dialog.OfflineSubmitConfirm),$("#offlineforms-submit-conformation-yes-btn").show(),$("#offlineforms-submit-conformation-modal .btn-link").html("No"),$("#offlineforms-submit-conformation-modal .btn-link").show(),$("#offlineforms-submit-conformation-modal").modal("show")})},function(){ssc.Spinner.destroyModalSpinner(),$("#offlineforms-submit-status-modal").modal("show")})}),window.offlineforms_save_conformation_yes_btn_click=function(a){ssc.Global.formStorage.saveFormAsOfflineSubmitInStorage(b(!0))},window.offlineforms_submit_conformation_yes_btn_click=function(a){ssc.formSubmitModule.callIfOnlineElse(function(){$("#offlineforms-submit-conformation-yes-btn").button("loading"),$("#offlineforms-submit-conformation-modal .info").text(ssc.Dialog.OfflineSubmitWait),$("#offlineforms-submit-conformation-modal .conform").text("3 Left"),$("#offlineforms-submit-conformation-modal .btn-link").hide(),ssc.formSubmitModule.submitOnceMultiForm()},function(){$("#offlineforms-submit-status-modal").modal("show")})},$("#onlineform-submit-status-modal .modal-dialog .modal-content,#offlineforms-submit-status-modal .modal-dialog .modal-content").on("click",function(a){a.stopPropagation(),$(this).closest(".modal").modal("hide")}),toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!0,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}});